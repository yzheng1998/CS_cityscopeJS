{"version":3,"sources":["redux/actions.js","redux/reducer.js","redux/store.js","services/cityIO/cityioDefault.js","services/cityIO/cityIO.js","components/menu/RangeSlider.js","components/menu/PaperSheet.js","components/menu/menu.js","components/menu/menuContainer.js","components/baseMap/baseMapUtils.js","services/consoleStyle.js","components/baseMap/baseMap.js","components/prjMap/util.ts","components/prjMap/anchor.tsx","components/prjMap/deleteLocalStorage.js","components/prjMap/layer.tsx","components/baseMap/baseMapContainer.js","components/vis/Radar/Radar.js","components/vis/visContainer.js","App.js","index.js"],"names":["GET_CITYIO_DATA","LISTEN_TO_MAP_EVENTS","LISTEN_TO_ABM_SLIDERS","MENU_INTERACTION","listOfToggles","Object","keys","settings","menu","toggles","menuInitState","i","length","values","push","initialState","MENU","CITYIO","MAP","SLIDERS","reducer","state","action","type","data","reduxDevTools","window","__REDUX_DEVTOOLS_EXTENSION__","configureStore","createStore","CityioFail","className","href","Component","CityIO","props","handleURL","tableName","location","search","substring","setState","userEnteredCityioEndpoint","cityioURL","cityIO","baseURL","toString","getCityIOHash","timer","setInterval","interval","console","log","URL","fetch","then","response","json","result","handleCityIOHashes","catch","e","id","oldHashs","cityIOmodulesStatus","readyToShareWithRedux","cityIOmodules","forEach","module","hashes","setNestedState","getCityIOmoduleData","checkDoneCityIO","moduleName","status","sharePropsWithRedux","cityIOmodulesData","getCityioData","parent","child","holder","axios","get","error","headers","request","message","config","this","mapDispatchToProps","connect","map","layers","ABM","startSimHour","endSimHour","sliderStart","Date","getHours","sliderEnd","marks","value","label","useStyles","makeStyles","root","width","listenToSlidersEvents","ABMlayerEvents","classes","React","useState","timeValue","setTimeValue","speedValue","setSpeedValue","Typography","gutterBottom","Slider","min","max","onChange","newValue","time","valueLabelDisplay","aria-labelledby","speed","theme","padding","spacing","position","bottom","left","PaperSheet","Paper","listenToMenuUI","menuState","maxWidth","margin","paper","background","color","list","fullList","menuButton","top","editButton","resetViewButton","createMuiTheme","palette","filter","k","String","toggleStateArray","setChecked","toggleDrawer","side","open","event","key","handleToggle","currentIndex","indexOf","newChecked","splice","checked","togglesCompsArray","thisToggle","ListItem","ListItemText","primary","ListItemSecondaryAction","Switch","edge","includes","ThemeProvider","Drawer","anchor","onClose","role","onClick","onKeyDown","List","Fab","MenuContainer","cityioData","grid","tzlookup","require","setDirLightSettings","header","hourAtLatLong","toLocaleString","timeZone","spatial","latitude","longitude","hour","hour12","getUTCHours","parseInt","_proccessGridData","types","TUIgridData","wholeGrid","meta_grid","interactiveGridData","interactive_grid_data","features","properties","interactiveMapping","interactive_grid_mapping","gridCellType","interactiveCellProps","cellValueByIndex","height","JSON","parse","stringify","_proccesnetworkGeojson","metaGrid","networkGeojson","pnttLatLong","geometry","coordinates","pnt","interactive_network_data","land_use","netWidth","_proccessGridTextData","textData","text","_proccessAccessData","accessData","access","d","heatmap","_postMapEditsToCityIO","endPoint","dataProps","post","consoleStyle","join","Map","_mulipleObjPicked","dim","pickingRadius","x","y","deckGL","pickObjects","_handleCellsSelection","randomType","multiSelectedObj","selected","thisCellProps","object","interactive","old_height","old_color","selectedCellsState","_handleCellsHover","_handleNetSelection","rndNetType","randomNetType","multiEdgeSelected","thisEdgeProps","selectedNetState","_renderSelectionTarget","mousePos","targetMetaData","rc","divSize","mouseX","clientX","mouseY","clientY","style","border","backgroundColor","mouseDown","borderColor","borderRadius","zIndex","pointerEvents","fontSize","name","_rndType","Math","random","netKeys","netTypes","_handleKeyUp","keyDownState","_handleKeyDown","nativeEvent","draggingWhileEditing","viewState","initialViewState","animationFrame","_onViewStateChange","bind","timeZoneOffset","dirLightSettings","timestamp","UTC","intensity","_shadow","cancelAnimationFrame","_rightClickViewRotate","_setupEffects","_setViewStateToTableHeader","prevProps","prevState","_animate","gridTextData","pitch","zoom","bearing","rotation","ambientLight","AmbientLight","dirLight","_SunLight","lightingEffect","LightingEffect","shadowColor","_effects","animationSpeed","t","offset","date","directionalLights","getFullYear","getMonth","getDay","getMinutes","getSeconds","requestAnimationFrame","document","getElementById","addEventListener","evt","preventDefault","TextLayer","getText","getPosition","getColor","getSize","ScatterplotLayer","pickable","opacity","stroked","filled","radiusScale","radiusMinPixels","radiusMaxPixels","getFillColor","getLineColor","getRadius","updateTriggers","transitions","onDrag","onDragStart","onDragEnd","GeoJsonLayer","visible","extruded","lineWidthScale","lineWidthMinPixels","getElevation","undefined","onHover","TripsLayer","getPath","path","getTimestamps","timestamps","mode","getWidth","rounded","trailLength","currentTime","PathLayer","noisePath","HeatmapLayer","colorRange","colors","radiusPixels","getWeight","housing","onKeyUp","onMouseMove","onMouseUp","onMouseDown","getCursor","ref","deck","onViewStateChange","_renderLayers","effects","controller","touchZoom","touchRotate","dragPan","dragRotate","keyboard","asyncRender","reuseMaps","mapboxApiAccessToken","process","mapStyle","blue","preventStyleDiffing","listenToMapEvents","solve","transformPointsToMatrix","sourcePoints","targetPoints","a","b","n","fromX","fromY","toX","toY","h","num","precision","factor","pow","tempNumber","round","matrixToTransform","matrix","vectorToTransform","vector","styles","container","cursor","anchorSize","right","AnchorComponent","translation","onMouseEnter","transform","button","DeleteLocalStorage","Grid","alignItems","justify","Button","variant","startIcon","anchors","defaultMatrix","_setDeltaVal","deltaInitVals","Layer","layerTranslateDelta","anchorTranslateDelta","isAnchorDragging","anchorMoving","translateDelta","transformOrigin","containerTranslate","onAnchorMouseDown","stopPropagation","pageX","pageY","onAnchorMouseMove","vectorIndexToModify","deltaX","deltaY","onAnchorMouseUp","isEditMode","newVector","_clearLocalStraoge","localStorage","getItem","removeItem","reload","getBoundingClientRect","ls","setItem","removeEventListener","anchorStyle","anchorClassName","display","children","index","MapContainer","_checkKeystone","Radar","domain","radar","radarData","radarSize","dataStatic","generateData","animation","domains","polygons","fillOpacity","strokeWidth","axes","fontWeight","fill","labels","textAnchor","stroke","tickValues","Array","v","VisContainer","store","App","ReactDOM","render"],"mappings":"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","file":"static/js/main.aee38632.chunk.js","sourcesContent":["/**\n * ACTIONS\n */\nexport const GET_CITYIO_DATA = \"GET_CITYIO_DATA\";\nexport function getCityioData(data) {\n    return { type: GET_CITYIO_DATA, data };\n}\n\nexport const LISTEN_TO_MAP_EVENTS = \"LISTEN_TO_MAP_EVENTS\";\nexport function listenToMapEvents(data) {\n    return { type: LISTEN_TO_MAP_EVENTS, data };\n}\n\nexport const LISTEN_TO_ABM_SLIDERS = \"LISTEN_TO_ABM_SLIDERS\";\nexport function listenToSlidersEvents(data) {\n    return { type: LISTEN_TO_ABM_SLIDERS, data };\n}\n\nexport const MENU_INTERACTION = \"MENU_INTERACTION\";\n\nexport function listenToMenuUI(data) {\n    return { type: MENU_INTERACTION, data };\n}\n","import settings from \"../settings/settings.json\";\n\nimport {\n    GET_CITYIO_DATA,\n    MENU_INTERACTION,\n    LISTEN_TO_MAP_EVENTS,\n    LISTEN_TO_ABM_SLIDERS\n} from \"./actions\";\n\n/**\n * INIT STATE\n */\nconst listOfToggles = Object.keys(settings.menu.toggles);\nlet menuInitState = [];\nfor (let i = 0; i < listOfToggles.length; i++) {\n    if (Object.values(settings.menu.toggles)[i]) {\n        menuInitState.push(listOfToggles[i]);\n    }\n}\nconst initialState = {\n    MENU: menuInitState,\n    CITYIO: {},\n    MAP: {},\n    SLIDERS: {}\n};\n\n/**\n * REDUCER\n */\nexport default function reducer(state = initialState, action) {\n    switch (action.type) {\n        case GET_CITYIO_DATA:\n            return { ...state, CITYIO: action.data };\n        case MENU_INTERACTION:\n            return { ...state, MENU: action.data };\n        case LISTEN_TO_MAP_EVENTS:\n            return { ...state, MAP: action.data };\n        case LISTEN_TO_ABM_SLIDERS:\n            return { ...state, SLIDERS: action.data };\n        default:\n            return state;\n    }\n}\n","import { createStore } from \"redux\";\nimport reducer from \"./reducer\";\n\nconst reduxDevTools =\n    window.__REDUX_DEVTOOLS_EXTENSION__ &&\n    window.__REDUX_DEVTOOLS_EXTENSION__();\n\nconst configureStore = () => {\n    const store = createStore(reducer, reduxDevTools);\n\n    if (process.env.NODE_ENV !== \"production\") {\n        if (module.hot) {\n            module.hot.accept(\"./reducer\", () => {\n                store.replaceReducer(reducer);\n            });\n        }\n    }\n\n    return store;\n};\n\nexport default configureStore;\n","import React, { Component } from \"react\";\nimport \"./cityioDefault.css\";\n\nclass CityioFail extends Component {\n    render() {\n        return (\n            <div className=\"background\">\n                <div className=\"info shadow\">\n                    <h1>CityScopeJS</h1>\n                    CityScopeJS is a unified front-end for the{\" \"}\n                    <a href=\"https://cityscope.media.mit.edu/\">\n                        MIT CityScope\n                    </a>{\" \"}\n                    project, an{\" \"}\n                    <a href=\"https://github.com/CityScope/CS_cityscopeJS\">\n                        open-source\n                    </a>{\" \"}\n                    urban modeling and simulation platform. Start by adding\n                    CityScope table name to the URL{\" \"}\n                    <small>\n                        [for example{\" \"}\n                        <a href=\"https://cityscope.media.mit.edu/CS_cityscopeJS/?grasbrook\">\n                            CityScopeJS Grasbrook\n                        </a>\n                        ]\n                    </small>{\" \"}\n                    or click <a href=\"https://cityio.media.mit.edu\"> here</a>{\" \"}\n                    for a list of active CityScope tables. <br />\n                    <br />\n                </div>\n            </div>\n        );\n    }\n}\n\nexport default CityioFail;\n","import React, { Component } from \"react\";\nimport axios from \"axios\";\nimport { connect } from \"react-redux\";\nimport { getCityioData } from \"../../redux/actions\";\nimport settings from \"../../settings/settings.json\";\nimport CityioFail from \"./cityioDefault\";\n\nclass CityIO extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            oldHashs: {},\n            userEnteredCityioEndpoint: false,\n            cityIOmodulesData: {}\n        };\n        this.cityioURL = null;\n    }\n\n    /**\n     * start fetching API hashes to check for new data\n     */\n    componentDidMount() {\n        this.handleURL();\n    }\n\n    handleURL = () => {\n        this.tableName = window.location.search.substring(1);\n        if (this.tableName !== \"\") {\n            this.setState({ userEnteredCityioEndpoint: true });\n            this.cityioURL =\n                settings.cityIO.baseURL + this.tableName.toString();\n            // get the hashes first\n            this.getCityIOHash(this.cityioURL + \"/meta\");\n            // and every interval\n            this.timer = setInterval(\n                () => this.getCityIOHash(this.cityioURL + \"/meta\"),\n                settings.cityIO.interval\n            );\n            console.log(\n                \"starting cityIO interval every..\",\n                settings.cityIO.interval\n            );\n        } else {\n            // no URL provided\n            this.setState({ userEnteredCityioEndpoint: false });\n        }\n    };\n\n    /**\n     * returns only the hasees from API\n     */\n    getCityIOHash = URL => {\n        fetch(URL)\n            .then(response => response.json())\n            .then(result => {\n                this.handleCityIOHashes(result);\n            })\n            .catch(e => {\n                console.log(e);\n            });\n    };\n\n    /**\n     * check for updated hashes.\n     * if new hashes exist,\n     * fetch !! WHOLE API (for now)\n     */\n    handleCityIOHashes = result => {\n        // if master hash ID has changed (cityIO table state)\n        if (result.id !== this.state.oldHashs.id) {\n            // reset the cityIOmodulesStatus\n            this.setState({ cityIOmodulesStatus: {} });\n\n            // reset the state of this flag\n            this.setState({ readyToShareWithRedux: false });\n\n            // new data in table, get all modules\n            // that are listed in settings\n            settings.cityIO.cityIOmodules.forEach(module => {\n                // only update modules that have new data\n                if (result.hashes[module] !== this.state.oldHashs[module]) {\n                    // set this module as not ready\n                    this.setNestedState(\"cityIOmodulesStatus\", module, false);\n                    // get the module data from cityIO\n                    this.getCityIOmoduleData(\n                        module,\n                        this.cityioURL + \"/\" + module\n                    );\n                    // update this new module hash in state\n                    this.setNestedState(\n                        \"oldHashs\",\n                        module,\n                        result.hashes[module]\n                    );\n                } else {\n                    // update module name with ok\n                    this.setNestedState(\"cityIOmodulesStatus\", module, true);\n                }\n            });\n            // finally, put to state the hashes master id\n            this.setNestedState(\"oldHashs\", \"id\", result.id);\n        }\n    };\n\n    checkDoneCityIO = moduleName => {\n        this.setNestedState(\"cityIOmodulesStatus\", moduleName, true);\n\n        // check if all modules are done\n        for (const status in this.state.cityIOmodulesStatus) {\n            if (this.state.cityIOmodulesStatus[status] !== true) {\n                // we still need to update some module, stop\n                return;\n            }\n        }\n        //  if so, change the state of 'readyToShareWithRedux'\n        this.setState({ readyToShareWithRedux: true });\n    };\n\n    sharePropsWithRedux = () => {\n        if (this.state.readyToShareWithRedux) {\n            const data = this.state.cityIOmodulesData;\n            data.tableName = this.tableName;\n            console.log(\"done updating from cityIO..\");\n            // finally, send data to redux\n            this.props.getCityioData(data);\n        }\n    };\n\n    setNestedState = (parent, child, data) => {\n        var holder = { ...this.state[parent] };\n        holder[child] = data;\n        this.setState({ [parent]: holder });\n    };\n\n    getCityIOmoduleData = (moduleName, URL) => {\n        axios\n            .get(URL)\n            .then(response => {\n                // put response to state obj\n                this.setNestedState(\n                    \"cityIOmodulesData\",\n                    moduleName,\n                    response.data\n                );\n                console.log(\"...updating module:\", moduleName);\n                this.checkDoneCityIO(moduleName);\n            })\n\n            .catch(error => {\n                if (error.response) {\n                    console.log(\n                        \"error.response:\",\n                        \"\\n\",\n                        error.response.data,\n                        \"\\n\",\n                        error.response.status,\n                        \"\\n\",\n                        error.response.headers\n                    );\n                } else if (error.request) {\n                    console.log(\"error.request:\", error.request);\n                } else {\n                    console.log(\"misc error:\", error.message);\n                }\n                console.log(\"request config:\", error.config);\n            });\n    };\n\n    render() {\n        if (this.state.userEnteredCityioEndpoint === false) {\n            return <CityioFail />;\n        } else {\n            this.sharePropsWithRedux();\n            return null;\n        }\n    }\n}\n\nconst mapDispatchToProps = {\n    getCityioData: getCityioData\n};\n\nexport default connect(null, mapDispatchToProps)(CityIO);\n","import React from \"react\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport Typography from \"@material-ui/core/Typography\";\nimport Slider from \"@material-ui/core/Slider\";\nimport settings from \"../../settings/settings.json\";\nimport { connect } from \"react-redux\";\nimport { listenToSlidersEvents } from \"../../redux/actions\";\n\nconst sixAm = 6 * 3600;\nconst { startSimHour, endSimHour } = settings.map.layers.ABM;\nconst sliderStart = new Date((sixAm + startSimHour) * 1000).getHours();\nconst sliderEnd = new Date((sixAm + endSimHour) * 1000).getHours();\n\nconst marks = [\n    {\n        value: 0,\n        label: \"12AM\"\n    },\n    {\n        value: 6,\n        label: \"6AM\"\n    },\n    {\n        value: 12,\n        label: \"12PM\"\n    },\n    {\n        value: 18,\n        label: \"6PM\"\n    }\n];\n\nconst useStyles = makeStyles({\n    root: {\n        width: \"100%\"\n    }\n});\n\nfunction RangeSlider(props) {\n    const classes = useStyles();\n    const [timeValue, setTimeValue] = React.useState([\n        sliderStart,\n        12,\n        sliderEnd\n    ]);\n\n    const [speedValue, setSpeedValue] = React.useState([50]);\n\n    const handleSetTimeValue = (e, newValue) => {\n        setTimeValue(newValue);\n        // ! not working\n        props.listenToSlidersEvents({\n            ...props,\n            SLIDERS: {\n                ...props,\n                time: newValue\n            }\n        });\n    };\n\n    const handleSetSpeedValue = (e, newValue) => {\n        setSpeedValue(newValue);\n        // ! not working\n        props.listenToSlidersEvents({\n            ...props,\n            SLIDERS: {\n                ...props,\n                speed: newValue\n            }\n        });\n    };\n\n    return (\n        <div className={classes.root}>\n            <Typography id=\"range-slider\" gutterBottom>\n                Simulation Range\n            </Typography>\n            <Slider\n                min={0}\n                max={23}\n                marks={marks}\n                value={timeValue}\n                onChange={handleSetTimeValue}\n                valueLabelDisplay=\"auto\"\n                aria-labelledby=\"range-slider\"\n            />\n            <Typography id=\"range-slider\" gutterBottom>\n                Simulation Speed\n            </Typography>\n            <Slider\n                min={0}\n                max={100}\n                value={speedValue}\n                onChange={handleSetSpeedValue}\n                valueLabelDisplay=\"auto\"\n                aria-labelledby=\"range-slider\"\n            />\n        </div>\n    );\n}\n\nconst mapStateToProps = state => {\n    return {\n        ABMlayerEvents: state.MAP\n    };\n};\n\nconst mapDispatchToProps = {\n    listenToSlidersEvents: listenToSlidersEvents\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(RangeSlider);\n","import React from \"react\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport Paper from \"@material-ui/core/Paper\";\nimport RangeSlider from \"./RangeSlider\";\n\nconst useStyles = makeStyles(theme => ({\n    root: {\n        padding: theme.spacing(1, 5),\n        position: \"fixed\",\n        bottom: \"3vw\",\n        left: \"3vw\",\n        width: \"20vw\"\n    }\n}));\n\nexport default function PaperSheet() {\n    const classes = useStyles();\n\n    return (\n        <Paper className={classes.root}>\n            <RangeSlider />\n        </Paper>\n    );\n}\n","import React from \"react\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport List from \"@material-ui/core/List\";\nimport { createMuiTheme } from \"@material-ui/core\";\nimport ListItem from \"@material-ui/core/ListItem\";\nimport ListItemSecondaryAction from \"@material-ui/core/ListItemSecondaryAction\";\nimport ListItemText from \"@material-ui/core/ListItemText\";\nimport Switch from \"@material-ui/core/Switch\";\nimport Drawer from \"@material-ui/core/Drawer\";\nimport Fab from \"@material-ui/core/Fab\";\nimport MenuIcon from \"@material-ui/icons/Menu\";\nimport EditIcon from \"@material-ui/icons/Edit\";\nimport CancelIcon from \"@material-ui/icons/Cancel\";\nimport { connect } from \"react-redux\";\nimport { listenToMenuUI } from \"../../redux/actions\";\nimport settings from \"../../settings/settings.json\";\nimport PaperSheet from \"./PaperSheet\";\nimport { ThemeProvider } from \"@material-ui/styles\";\nimport NearMeIcon from \"@material-ui/icons/NearMe\";\nimport NavigationIcon from \"@material-ui/icons/Navigation\";\n\n// import CircularProgress from \"@material-ui/core/CircularProgress\";\n\nfunction Menu(props) {\n    const listOfToggles = Object.keys(settings.menu.toggles);\n    const useStyles = makeStyles(theme => ({\n        root: {\n            width: \"100%\",\n            maxWidth: \"15em\",\n            position: \"absolute\",\n            \"& > *\": {\n                margin: theme.spacing(1)\n            }\n        },\n        paper: {\n            background: \"black\",\n            color: \"white\"\n        },\n        list: {\n            width: \"15em\"\n        },\n        fullList: {\n            width: \"auto\"\n        },\n\n        menuButton: {\n            position: \"fixed\",\n            top: theme.spacing(2),\n            left: theme.spacing(2)\n        },\n        editButton: {\n            position: \"fixed\",\n            top: theme.spacing(12),\n            left: theme.spacing(2)\n        },\n        resetViewButton: {\n            position: \"fixed\",\n            top: theme.spacing(22),\n            left: theme.spacing(2)\n        }\n    }));\n\n    const classes = useStyles();\n    const theme = createMuiTheme({\n        palette: {\n            type: \"dark\"\n        }\n    });\n    const [toggleStateArray, setChecked] = React.useState(\n        Object.keys(settings.menu.toggles)\n            .filter(function(k) {\n                return settings.menu.toggles[k];\n            })\n            .map(String)\n    );\n\n    const [state, setState] = React.useState({\n        left: false\n    });\n\n    const toggleDrawer = (side, open) => event => {\n        if (\n            event.type === \"keydown\" &&\n            (event.key === \"Tab\" || event.key === \"Shift\")\n        ) {\n            return;\n        }\n\n        setState({ ...state, [side]: open });\n    };\n\n    const sideList = side => (\n        <div\n            className={classes.list}\n            role=\"presentation\"\n            onClick={toggleDrawer(side, false)}\n            onKeyDown={toggleDrawer(side, false)}\n        ></div>\n    );\n    const handleToggle = value => () => {\n        const currentIndex = toggleStateArray.indexOf(value);\n        const newChecked = [...toggleStateArray];\n        if (currentIndex === -1) {\n            newChecked.push(value);\n        } else {\n            newChecked.splice(currentIndex, 1);\n        }\n        setChecked(newChecked);\n        setState({ ...state, checked: newChecked });\n\n        props.listenToMenuUI(newChecked);\n    };\n\n    let togglesCompsArray = [];\n    for (let i = 0; i < listOfToggles.length; i++) {\n        const thisToggle = (\n            <ListItem key={listOfToggles[i]}>\n                {/* <CircularProgress size={20} thickness={5} /> */}\n\n                <ListItemText primary={listOfToggles[i]} />\n                <ListItemSecondaryAction>\n                    <Switch\n                        /**\n                         * gets props with initial menu state\n                         * and turn on the layer on init\n                         */\n                        edge=\"end\"\n                        onChange={handleToggle(listOfToggles[i])}\n                        checked={\n                            props.menuState.includes(listOfToggles[i])\n                                ? true\n                                : false\n                        }\n                    />\n                </ListItemSecondaryAction>\n            </ListItem>\n        );\n        togglesCompsArray.push(thisToggle);\n    }\n\n    const renderABMslider = () => {\n        if (state.checked && state.checked.includes(\"ABM\")) {\n            return <PaperSheet />;\n        } else return null;\n    };\n\n    return (\n        <ThemeProvider theme={theme}>\n            <div className={classes.root}>\n                <Drawer\n                    anchor=\"left\"\n                    open={state.left}\n                    onClose={toggleDrawer(\"left\", false)}\n                >\n                    {sideList(\"left\")}\n                    <List className={classes.root}>\n                        <h2>cityscopeJS</h2>\n                        {togglesCompsArray}\n                    </List>\n                </Drawer>\n            </div>\n\n            <Fab\n                className={classes.menuButton}\n                onClick={toggleDrawer(\"left\", true)}\n            >\n                <MenuIcon />\n            </Fab>\n            <Fab className={classes.editButton} onClick={handleToggle(\"EDIT\")}>\n                {toggleStateArray.includes(\"EDIT\") ? (\n                    <CancelIcon />\n                ) : (\n                    <EditIcon />\n                )}\n            </Fab>\n\n            <Fab\n                className={classes.resetViewButton}\n                onClick={handleToggle(\"RESET_VIEW\")}\n            >\n                {toggleStateArray.includes(\"RESET_VIEW\") ? (\n                    <NavigationIcon />\n                ) : (\n                    <NearMeIcon />\n                )}\n            </Fab>\n\n            {renderABMslider()}\n        </ThemeProvider>\n    );\n}\n\nconst mapStateToProps = state => {\n    return {\n        menuState: state.MENU\n    };\n};\n\nconst mapDispatchToProps = {\n    listenToMenuUI: listenToMenuUI\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Menu);\n","import React, { Component } from \"react\";\nimport { connect } from \"react-redux\";\nimport Menu from \"./menu\";\n\nclass MenuContainer extends Component {\n    render() {\n        if (this.props.cityioData && this.props.cityioData.grid) {\n            return <Menu />;\n        } else {\n            return null;\n        }\n    }\n}\n\nconst mapStateToProps = state => {\n    return {\n        cityioData: state.CITYIO\n    };\n};\n\nexport default connect(mapStateToProps, null)(MenuContainer);\n","import settings from \"../../settings/settings.json\";\nimport axios from \"axios\";\nvar tzlookup = require(\"tz-lookup\");\n\n/**\n * returns time for table location\n * for the light emlement\n * @param {*} header\n */\n\nexport const setDirLightSettings = header => {\n    // get the hour element of this location\n    let hourAtLatLong = new Date().toLocaleString(\"en-US\", {\n        timeZone: tzlookup(header.spatial.latitude, header.spatial.longitude),\n        hour: \"2-digit\",\n        hour12: false\n    });\n\n    // get the time in greenwich\n    var greenwichDate = new Date();\n    var greenwichHours = greenwichDate.getUTCHours();\n    // calc the offset\n    let timeZoneOffset = greenwichHours + 24 - parseInt(hourAtLatLong);\n    return timeZoneOffset;\n};\n\n/**\n * Description. gets `props` with geojson\n * and procces the interactive area\n */\nexport const _proccessGridData = cityioData => {\n    let types = settings.map.types;\n    const TUIgridData = cityioData.grid;\n\n    const wholeGrid = cityioData.meta_grid;\n    const interactiveGridData = cityioData.interactive_grid_data;\n    // update meta_grid features from cityio\n    if (interactiveGridData) {\n        for (let i = 0; i < wholeGrid.features.length; i++) {\n            wholeGrid.features[i].properties = interactiveGridData[i];\n        }\n    }\n\n    // handles TUI grid data on update\n    const interactiveMapping = cityioData.interactive_grid_mapping;\n    for (let i in interactiveMapping) {\n        // type is the first value in the cell array\n        // the rotation is the 2nd\n        let gridCellType = TUIgridData[i][0];\n        let interactiveCellProps =\n            wholeGrid.features[interactiveMapping[i]].properties;\n        // set up the cell type\n        interactiveCellProps.type = gridCellType;\n\n        // check if not undefined type (no scanning)\n\n        if (TUIgridData[i][0] !== -1) {\n            // get value of cell from settings via its index\n            let cellValueByIndex = Object.values(types)[TUIgridData[i][0]];\n            // cast the cell color\n            interactiveCellProps.color = cellValueByIndex.color;\n            // cast the cell height\n            interactiveCellProps.height = cellValueByIndex.height;\n        } else {\n            console.log(\"... got null type...\");\n        }\n    }\n    const newGrid = JSON.parse(JSON.stringify(wholeGrid));\n    return newGrid;\n};\n\n/**\n * proccess grid data to geojson\n * of lineStrings\n * @param {cityIOdata} data\n * \n \nfeatures  :[\n    {\n        type: \"Feature\",\n        properties: {},\n        geometry: {\n            type: \"Point\",\n            coordinates: [125.6, 10.1]\n        },\n        properties: {\n            name: \"Dinagat Islands\"\n        }\n    }...\n]\n */\n\nexport const _proccesnetworkGeojson = cityioData => {\n    const metaGrid = cityioData.meta_grid.features;\n    const networkGeojson = {\n        type: \"FeatureCollection\",\n        features: []\n    };\n    // update meta_grid features from cityio\n    if (metaGrid) {\n        for (let i = 0; i < metaGrid.length; i++) {\n            const pnttLatLong = metaGrid[i].geometry.coordinates[0][0];\n            let id = i;\n            let props;\n            if (cityioData.interactive_network_data) {\n                props = cityioData.interactive_network_data[id];\n            } else {\n                props = {\n                    land_use: \"network\",\n                    netWidth: 5,\n                    color: [255, 255, 255, 1],\n                    id: id\n                };\n            }\n            const pnt = {\n                type: \"Feature\",\n                properties: props,\n                geometry: {\n                    type: \"Point\",\n                    coordinates: pnttLatLong\n                }\n            };\n            networkGeojson.features.push(pnt);\n        }\n    }\n    return networkGeojson;\n};\n\n/**\n * Data format:\n * [\n *   {text: 'type', coordinates: [-122.466233, 37.684638]},\n *   ...\n * ]\n *\n * Grid data format:\n * features[i].geometry.coordinates[0][0]\n */\nexport const _proccessGridTextData = data => {\n    const meta_grid = data.meta_grid;\n    let textData = [];\n    for (let i = 0; i < meta_grid.features.length; i++) {\n        textData[i] = {\n            text: meta_grid.features[i].properties.height.toString(),\n            coordinates: [\n                meta_grid.features[i].geometry.coordinates[0][0][0],\n                meta_grid.features[i].geometry.coordinates[0][0][1],\n                meta_grid.features[i].properties.height + 10\n            ]\n        };\n    }\n    return textData;\n};\n\n/**\n * Description. gets `props` with geojson\n * and procces the access layer data\n */\nexport const _proccessAccessData = data => {\n    const accessData = data.access;\n    // get colors from settings\n    let coordinates = accessData.features.map(d => d.geometry.coordinates);\n    let values = accessData.features.map(d => d.properties);\n    let heatmap = [];\n    for (let i = 0; i < coordinates.length; i++) {\n        heatmap.push({\n            coordinates: coordinates[i],\n            values: values[i]\n        });\n    }\n    return heatmap;\n};\n\n/**\n * checks if edits are done (toggled off)\n * than returns a redux state\n * with grid edits payload\n */\nexport const _postMapEditsToCityIO = (data, tableName, endPoint) => {\n    let dataProps = [];\n    for (let i = 0; i < data.features.length; i++) {\n        dataProps[i] = data.features[i].properties;\n    }\n\n    axios\n        .post(\n            \"https://cityio.media.mit.edu/api/table/update/\" +\n                tableName +\n                endPoint,\n            dataProps\n        )\n        .then(response => {\n            console.log(response);\n        })\n        .catch(error => {\n            console.log(error);\n        });\n};\n","export const consoleStyle = [\n    \"background: linear-gradient(#10B500, #0086B5)\",\n    \"border: 3px solid #ffffff\",\n    \"color: white\",\n    \"display: block\",\n    \"text-shadow: 0 1px 0 rgba(0, 0, 0, 0.5)\",\n    \"line-height: 40px\",\n    \"text-align: center\",\n    \"font-weight: bold\"\n].join(\";\");\n","/* global window */\nimport React, { Component } from \"react\";\nimport { connect } from \"react-redux\";\nimport { listenToMapEvents } from \"../../redux/actions\";\nimport {\n    _proccesnetworkGeojson,\n    _proccessAccessData,\n    _proccessGridData,\n    _postMapEditsToCityIO,\n    _proccessGridTextData,\n    setDirLightSettings\n} from \"./baseMapUtils\";\nimport { StaticMap } from \"react-map-gl\";\nimport DeckGL from \"@deck.gl/react\";\nimport { TripsLayer } from \"@deck.gl/geo-layers\";\nimport \"mapbox-gl/dist/mapbox-gl.css\";\nimport {\n    HeatmapLayer,\n    PathLayer,\n    GeoJsonLayer,\n    TextLayer,\n    ScatterplotLayer\n} from \"deck.gl\";\nimport { LightingEffect, AmbientLight, _SunLight } from \"@deck.gl/core\";\nimport settings from \"../../settings/settings.json\";\nimport { consoleStyle } from \"../../services/consoleStyle\";\nclass Map extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            menu: null,\n            cityioData: null,\n            draggingWhileEditing: false,\n            selectedCellsState: null,\n            selectedNetState: null,\n            time: 0,\n            pickingRadius: 40,\n            viewState: settings.map.initialViewState\n        };\n        this.animationFrame = null;\n        this._onViewStateChange = this._onViewStateChange.bind(this);\n        this.timeZoneOffset = setDirLightSettings(this.props.cityioData.header);\n        this.dirLightSettings = {\n            timestamp: Date.UTC(2019, 7, 1, 11 + this.timeZoneOffset),\n            color: [255, 255, 255],\n            intensity: 1.0,\n            _shadow: true\n        };\n    }\n\n    componentWillUnmount() {\n        if (this.animationFrame) {\n            window.cancelAnimationFrame(this.animationFrame);\n        }\n    }\n\n    componentDidMount() {\n        // fix deck view rotate\n        this._rightClickViewRotate();\n        // setup sun effects\n        this._setupEffects();\n        // zoom map on CS table location\n        this._setViewStateToTableHeader();\n    }\n\n    /**\n     * handels events as they derived from redux props\n     */\n    componentDidUpdate(prevProps, prevState) {\n        if (prevProps.menu !== prevState.menu) {\n            this.setState({ menu: this.props.menu });\n            // start ainmation/sim/roate\n            this._animate();\n        }\n\n        if (prevState.cityioData !== this.props.cityioData) {\n            console.log(\"%c new cityioData data to render \", consoleStyle);\n            // get cityio data from props\n            const cityioData = this.props.cityioData;\n            this.setState({\n                cityioData: cityioData,\n                meta_grid: _proccessGridData(cityioData),\n                gridTextData: _proccessGridTextData(cityioData),\n                networkGeojson: _proccesnetworkGeojson(cityioData)\n            });\n\n            // ! workaround for preloading access layer data\n            if (this.props.cityioData.access) {\n                this.setState({ access: _proccessAccessData(cityioData) });\n            }\n\n            // FOR NOW FAKE TYPE\n            this._rndType();\n        }\n\n        //    toggle edit mode\n        if (\n            prevProps.menu.includes(\"EDIT\") &&\n            !this.props.menu.includes(\"EDIT\")\n        ) {\n            _postMapEditsToCityIO(\n                this.state.meta_grid,\n\n                this.props.cityioData.tableName,\n                \"/interactive_grid_data\"\n            );\n\n            _postMapEditsToCityIO(\n                this.state.networkGeojson,\n\n                this.props.cityioData.tableName,\n                \"/interactive_network_data\"\n            );\n        }\n\n        //    toggle reset view mode\n        if (\n            !prevProps.menu.includes(\"RESET_VIEW\") &&\n            this.props.menu.includes(\"RESET_VIEW\")\n        ) {\n            this._setViewStateToTableHeader();\n        } else if (\n            prevProps.menu.includes(\"RESET_VIEW\") &&\n            !this.props.menu.includes(\"RESET_VIEW\")\n        ) {\n            this.setState({\n                viewState: {\n                    ...this.state.viewState,\n                    pitch: 45\n                }\n            });\n        }\n    }\n\n    _onViewStateChange({ viewState }) {\n        this.setState({ viewState });\n    }\n\n    /**\n     * resets the camera viewport\n     * to cityIO header data\n     * https://github.com/uber/deck.gl/blob/master/test/apps/viewport-transitions-flyTo/src/app.js\n     */\n    _setViewStateToTableHeader() {\n        const header = this.props.cityioData.header;\n        this.setState({\n            viewState: {\n                ...this.state.viewState,\n                longitude: header.spatial.longitude,\n                latitude: header.spatial.latitude,\n                zoom: 14,\n                pitch: 0,\n                bearing: 180 - header.spatial.rotation\n            }\n        });\n    }\n\n    _setupEffects() {\n        const ambientLight = new AmbientLight({\n            color: [255, 255, 255],\n            intensity: 0.85\n        });\n        const dirLight = new _SunLight(this.dirLightSettings);\n        const lightingEffect = new LightingEffect({ ambientLight, dirLight });\n        lightingEffect.shadowColor = [0, 0, 0, 0.5];\n        this._effects = [lightingEffect];\n    }\n\n    _animate() {\n        /**\n         * remove the binded animation when comp updates\n         */\n        window.cancelAnimationFrame(this.animationFrame);\n\n        if (this.props.menu.includes(\"ABM\")) {\n            const {\n                startSimHour,\n                animationSpeed,\n                endSimHour\n            } = settings.map.layers.ABM;\n\n            let t = this.state.time + animationSpeed;\n            if (\n                this.state.time > endSimHour ||\n                this.state.time < startSimHour\n            ) {\n                t = startSimHour;\n            }\n\n            let offset = this.timeZoneOffset * 3600;\n            var date = new Date(\n                (startSimHour + offset + this.state.time) * 1000\n            );\n            this._effects[0].directionalLights[0].timestamp = Date.UTC(\n                date.getFullYear(),\n                date.getMonth(),\n                date.getDay(),\n                date.getHours(),\n                date.getMinutes(),\n                date.getSeconds()\n            );\n\n            this.setState({ time: t });\n        }\n        if (this.props.menu.includes(\"ROTATE\")) {\n            let bearing = this.state.viewState.bearing\n                ? this.state.viewState.bearing\n                : 0;\n            bearing < 360 ? (bearing += 0.05) : (bearing = 0);\n\n            this.setState({\n                viewState: {\n                    ...this.state.viewState,\n                    bearing: bearing\n                }\n            });\n        }\n\n        this.animationFrame = window.requestAnimationFrame(\n            this._animate.bind(this)\n        );\n\n        // stop animation on state\n        if (!this.props.menu.includes(\"ABM\")) {\n            // && this.animationFrame\n            this._effects[0].directionalLights[0].timestamp = this.dirLightSettings.timestamp;\n            return;\n        }\n    }\n\n    /**\n     * Description. fix deck issue\n     * with rotate right botton\n     */\n    _rightClickViewRotate() {\n        document\n            .getElementById(\"deckgl-wrapper\")\n            .addEventListener(\"contextmenu\", evt => evt.preventDefault());\n    }\n\n    /**\n     * Description. uses deck api to\n     * collect objects in a region\n     * @argument{object} e  picking event\n     */\n    _mulipleObjPicked = e => {\n        const dim = this.state.pickingRadius;\n        const x = e.x - dim / 2;\n        const y = e.y - dim / 2;\n        let mulipleObj = this.deckGL.pickObjects({\n            x: x,\n            y: y,\n            width: dim,\n            height: dim\n        });\n        return mulipleObj;\n    };\n\n    /**\n     * Description. allow only to pick cells that are\n     *  not of CityScope TUI & that are interactable\n     * so to not overlap TUI activity\n     */\n    _handleCellsSelection = e => {\n        const randomType = this.state.randomType;\n        const multiSelectedObj = this._mulipleObjPicked(e);\n        multiSelectedObj.forEach(selected => {\n            const thisCellProps = selected.object.properties;\n            if (\n                thisCellProps.land_use !== \"None\" &&\n                !thisCellProps.interactive\n            ) {\n                thisCellProps.old_height = thisCellProps.height;\n                thisCellProps.old_color = thisCellProps.color;\n                thisCellProps.color = randomType.color;\n                thisCellProps.height = randomType.height;\n            }\n\n            this.setState({\n                selectedCellsState: multiSelectedObj\n            });\n        });\n    };\n\n    _handleCellsHover = e => {\n        const randomType = this.state.randomType;\n\n        if (e.object && e.object.properties) {\n            const thisCellProps = e.object.properties;\n            if (\n                thisCellProps.land_use !== \"None\" &&\n                !thisCellProps.interactive\n            ) {\n                thisCellProps.old_color = thisCellProps.color;\n                thisCellProps.color = randomType.color;\n                this.setState({\n                    selectedCellsState: e.object\n                });\n                thisCellProps.color = thisCellProps.old_color;\n                this.setState({\n                    selectedCellsState: e.object\n                });\n            }\n        }\n    };\n\n    /**\n     * Description. allow only to pick net edges\n     */\n    _handleNetSelection = e => {\n        const rndNetType = this.state.randomNetType;\n        const multiEdgeSelected = this._mulipleObjPicked(e);\n        multiEdgeSelected.forEach(edge => {\n            const thisEdgeProps = edge.object.properties;\n            // network edges selected\n            if (thisEdgeProps.land_use === \"network\") {\n                thisEdgeProps.old_color = thisEdgeProps.color;\n                thisEdgeProps.color = rndNetType.color;\n                thisEdgeProps.netWidth = rndNetType.width;\n            }\n        });\n        this.setState({\n            selectedNetState: multiEdgeSelected\n        });\n    };\n\n    /**\n     * Description.\n     * draw target area around mouse\n     */\n    _renderSelectionTarget = () => {\n        if (this.props.menu.includes(\"EDIT\") && this.state.mousePos) {\n            const targetMetaData =\n                !this.props.menu.includes(\"GRID\") &&\n                this.props.menu.includes(\"NETWORK\")\n                    ? this.state.randomNetType\n                    : this.state.randomType;\n            const rc = targetMetaData.color;\n            const color = \"rgb(\" + rc[0] + \",\" + rc[1] + \",\" + rc[2] + \")\";\n            const mousePos = this.state.mousePos;\n            const divSize = this.state.pickingRadius;\n\n            let mouseX = mousePos.clientX - divSize / 2;\n            let mouseY = mousePos.clientY - divSize / 2;\n\n            return (\n                <div\n                    style={{\n                        border: \"2px solid\",\n                        backgroundColor: this.state.mouseDown\n                            ? \"rgba(\" +\n                              rc[0] +\n                              \",\" +\n                              rc[1] +\n                              \",\" +\n                              rc[2] +\n                              \",0.6)\"\n                            : \"rgba(0,0,0,0)\",\n                        borderColor: color,\n                        color: color,\n                        borderRadius: \"15%\",\n                        position: \"fixed\",\n                        zIndex: 1,\n                        pointerEvents: \"none\",\n                        width: divSize,\n                        height: divSize,\n                        left: mouseX,\n                        top: mouseY\n                    }}\n                >\n                    <div\n                        style={{\n                            position: \"relative\",\n                            left: divSize + 10,\n                            fontSize: \"1vw\"\n                        }}\n                    >\n                        {targetMetaData.name}\n                    </div>\n                </div>\n            );\n        }\n    };\n\n    /**\n     * Description.\n     * Temp def. for color selection\n     */\n    _rndType = () => {\n        var keys = Object.keys(settings.map.types);\n        let randomType =\n            settings.map.types[keys[(keys.length * Math.random()) << 0]];\n        this.setState({ randomType: randomType });\n        // net type !TEMP\n        var netKeys = Object.keys(settings.map.netTypes);\n        let randomNetType =\n            settings.map.netTypes[\n                netKeys[(netKeys.length * Math.random()) << 0]\n            ];\n        this.setState({ randomNetType: randomNetType });\n    };\n\n    _handleKeyUp = () => {\n        this.setState({ keyDownState: null });\n    };\n\n    _handleKeyDown = e => {\n        // avoid common clicks\n        this.setState({ keyDownState: e.nativeEvent.key });\n        // compute rnd color for now\n        if (e.nativeEvent.key === \" \") {\n            this._rndType();\n        } else if (\n            e.nativeEvent.key === \"=\" &&\n            this.state.pickingRadius < 100\n        ) {\n            this.setState({ pickingRadius: this.state.pickingRadius + 5 });\n        } else if (e.nativeEvent.key === \"-\" && this.state.pickingRadius > 0) {\n            this.setState({ pickingRadius: this.state.pickingRadius - 5 });\n        }\n    };\n\n    /**\n     * renders deck gl layers\n     */\n    _renderLayers() {\n        const cityioData = this.props.cityioData;\n        let layers = [];\n\n        if (this.props.menu.includes(\"TEXT\")) {\n            layers.push(\n                new TextLayer({\n                    id: \"gridText-layer\",\n                    data: this.state.gridTextData,\n                    getText: d => d.text,\n                    getPosition: d => d.coordinates,\n                    getColor: [255, 255, 255],\n                    getSize: 16\n                })\n            );\n        }\n\n        if (\n            this.props.menu.includes(\"NETWORK\") &&\n            this.state.networkGeojson &&\n            this.state.networkGeojson.features\n        ) {\n            layers.push(\n                new ScatterplotLayer({\n                    id: \"NETWORK\",\n                    data: this.state.networkGeojson.features,\n                    pickable: true,\n                    opacity: 0.8,\n                    stroked: true,\n                    filled: true,\n                    radiusScale: 1,\n                    radiusMinPixels: 1,\n                    radiusMaxPixels: 20,\n                    getPosition: d => d.geometry.coordinates,\n                    // getColor: d => d.properties.color,\n                    getFillColor: [0, 0, 0, 0],\n                    getLineColor: d => d.properties.color,\n                    getRadius: d => d.properties.netWidth,\n                    updateTriggers: {\n                        getLineColor: this.state.selectedNetState,\n                        getRadius: this.state.selectedNetState\n                    },\n                    transitions: {\n                        getLineColor: 500,\n                        getRadius: 500\n                    },\n                    onClick: event => {\n                        if (\n                            this.props.menu.includes(\"EDIT\") &&\n                            this.state.keyDownState !== \"Shift\"\n                        )\n                            this._handleNetSelection(event);\n                    },\n                    onDrag: event => {\n                        if (\n                            this.props.menu.includes(\"EDIT\") &&\n                            this.state.keyDownState !== \"Shift\"\n                        )\n                            this._handleNetSelection(event);\n                    },\n                    onDragStart: () => {\n                        if (\n                            this.props.menu.includes(\"EDIT\") &&\n                            this.state.keyDownState !== \"Shift\"\n                        ) {\n                            this.setState({ draggingWhileEditing: true });\n                        }\n                    },\n                    onDragEnd: () => {\n                        this.setState({ draggingWhileEditing: false });\n                    }\n                })\n            );\n        }\n\n        if (this.props.menu.includes(\"GRID\")) {\n            layers.push(\n                new GeoJsonLayer({\n                    id: \"GRID\",\n                    data: this.state.meta_grid,\n                    visible: this.props.menu.includes(\"GRID\") ? true : false,\n                    pickable: true,\n                    extruded: true,\n                    lineWidthScale: 1,\n                    lineWidthMinPixels: 2,\n                    getElevation: d =>\n                        d.properties.land_use !== \"None\"\n                            ? d.properties.height\n                            : 0,\n                    getFillColor: d =>\n                        d.properties.type !== undefined\n                            ? d.properties.color\n                            : d.properties.color\n                            ? d.properties.color\n                            : d.properties.land_use !== \"None\"\n                            ? settings.map.types[1].color\n                            : settings.map.types[0].color,\n                    onClick: event => {\n                        if (\n                            this.props.menu.includes(\"EDIT\") &&\n                            this.state.keyDownState !== \"Shift\"\n                        )\n                            this._handleCellsSelection(event);\n                    },\n                    onHover: event => {\n                        if (\n                            this.props.menu.includes(\"EDIT\") &&\n                            this.state.keyDownState !== \"Shift\"\n                        )\n                            this._handleCellsHover(event);\n                    },\n                    onDrag: event => {\n                        if (\n                            this.props.menu.includes(\"EDIT\") &&\n                            this.state.keyDownState !== \"Shift\"\n                        )\n                            this._handleCellsSelection(event);\n                    },\n                    onDragStart: () => {\n                        if (\n                            this.props.menu.includes(\"EDIT\") &&\n                            this.state.keyDownState !== \"Shift\"\n                        ) {\n                            this.setState({ draggingWhileEditing: true });\n                        }\n                    },\n                    onDragEnd: () => {\n                        this.setState({ draggingWhileEditing: false });\n                    },\n                    updateTriggers: {\n                        getFillColor: this.state.selectedCellsState,\n                        getElevation: this.state.selectedCellsState\n                    },\n                    transitions: {\n                        getFillColor: 500,\n                        getElevation: 500\n                    }\n                })\n            );\n        }\n\n        if (this.props.menu.includes(\"ABM\")) {\n            layers.push(\n                new TripsLayer({\n                    id: \"ABM\",\n                    visible: this.props.menu.includes(\"ABM\") ? true : false,\n                    data: cityioData.ABM,\n                    // getPath: d => d.path,\n                    getPath: d => {\n                        for (let i in d.path) {\n                            d.path[i][2] = 20;\n                        }\n                        return d.path;\n                    },\n\n                    getTimestamps: d => d.timestamps,\n                    getColor: d => {\n                        //switch between modes or types of users\n                        switch (d.mode[1]) {\n                            case 0:\n                                return [255, 0, 0];\n                            case 1:\n                                return [0, 0, 255];\n                            case 2:\n                                return [0, 255, 0];\n                            default:\n                                return [0, 0, 0];\n                        }\n                    },\n                    getWidth: 2,\n                    opacity: 0.8,\n                    rounded: true,\n                    trailLength: 500,\n                    currentTime: this.state.time\n                })\n            );\n        }\n\n        if (this.props.menu.includes(\"PATHS\")) {\n            layers.push(\n                new PathLayer({\n                    id: \"PATHS\",\n                    visible: this.props.menu.includes(\"PATHS\") ? true : false,\n                    _shadow: false,\n                    data: cityioData.ABM,\n                    getPath: d => {\n                        const noisePath =\n                            Math.random() < 0.5\n                                ? Math.random() * 0.00005\n                                : Math.random() * -0.00005;\n                        for (let i in d.path) {\n                            d.path[i][0] = d.path[i][0] + noisePath;\n                            d.path[i][1] = d.path[i][1] + noisePath;\n                            d.path[i][2] = 10;\n                        }\n                        return d.path;\n                    },\n                    getColor: d => {\n                        switch (d.mode[1]) {\n                            case 0:\n                                return [255, 0, 0];\n                            case 1:\n                                return [0, 0, 255];\n                            case 2:\n                                return [0, 255, 0];\n                            default:\n                                return [0, 0, 0];\n                        }\n                    },\n                    opacity: 0.2,\n                    getWidth: 1\n                })\n            );\n        }\n\n        if (this.props.menu.includes(\"ACCESS\")) {\n            layers.push(\n                new HeatmapLayer({\n                    id: \"ACCESS\",\n                    visible: this.props.menu.includes(\"ACCESS\") ? true : false,\n                    colorRange: settings.map.layers.heatmap.colors,\n                    radiusPixels: 200,\n                    opacity: 0.25,\n                    data: this.state.access,\n                    getPosition: d => d.coordinates,\n                    getWeight: d => d.values.housing\n                })\n            );\n        }\n        return layers;\n    }\n\n    render() {\n        return (\n            <div\n                onKeyDown={this._handleKeyDown}\n                onKeyUp={this._handleKeyUp}\n                onMouseMove={e =>\n                    this.setState({\n                        mousePos: e.nativeEvent\n                    })\n                }\n                onMouseUp={() =>\n                    this.setState({\n                        mouseDown: false\n                    })\n                }\n                onMouseDown={() =>\n                    this.setState({\n                        mouseDown: true\n                    })\n                }\n            >\n                {/* renders the slection box div */}\n                <div>{this._renderSelectionTarget()}</div>\n\n                <DeckGL\n                    // sets the cursor on paint\n                    getCursor={() =>\n                        this.props.menu.includes(\"EDIT\") ? \"none\" : \"all-scroll\"\n                    }\n                    ref={ref => {\n                        // save a reference to the Deck instance\n                        this.deckGL = ref && ref.deck;\n                    }}\n                    viewState={this.state.viewState}\n                    onViewStateChange={this._onViewStateChange}\n                    layers={this._renderLayers()}\n                    effects={this._effects}\n                    controller={{\n                        touchZoom: true,\n                        touchRotate: true,\n                        dragPan: !this.state.draggingWhileEditing,\n                        dragRotate: !this.state.draggingWhileEditing,\n                        keyboard: false\n                    }}\n                >\n                    <StaticMap\n                        asyncRender={true}\n                        dragRotate={true}\n                        reuseMaps={true}\n                        mapboxApiAccessToken={\n                            process.env.REACT_APP_MAPBOX_TOKEN\n                        }\n                        mapStyle={settings.map.mapStyle.blue}\n                        preventStyleDiffing={true}\n                    />\n                </DeckGL>\n            </div>\n        );\n    }\n}\n\nconst mapDispatchToProps = {\n    listenToMapEvents: listenToMapEvents\n};\n\nexport default connect(null, mapDispatchToProps)(Map);\n","import { Matrix3d, RectPoints, Vector } from \"./layer\";\nconst { solve } = require(\"numeric\");\n\nexport const round = (num: number, precision: number) => {\n    var factor = Math.pow(10, precision);\n    var tempNumber = num * factor;\n    var roundedTempNumber = Math.round(tempNumber);\n    return roundedTempNumber / factor;\n};\n\n// tslint:disable-next-line:no-any\nexport const range = (num: number) =>\n    (Array as any)(num)\n        .fill()\n        .map((_: any, i: any) => i * i);\n\nexport const transformPointsToMatrix = (\n    sourcePoints: RectPoints,\n    targetPoints: RectPoints\n): Matrix3d => {\n    const a: number[][] = [];\n    const b: number[] = [];\n\n    for (let i = 0, n = sourcePoints.length; i < n; ++i) {\n        const [fromX, fromY] = sourcePoints[i];\n        const [toX, toY] = targetPoints[i];\n\n        a.push(\n            [fromX, fromY, 1, 0, 0, 0, -fromX * toX, -fromY * toX],\n            [0, 0, 0, fromX, fromY, 1, -fromX * toY, -fromY * toY]\n        );\n\n        b.push(toX, toY);\n    }\n\n    const h = solve(a, b, true);\n\n    return [\n        h[0],\n        h[3],\n        0,\n        h[6],\n        h[1],\n        h[4],\n        0,\n        h[7],\n        0,\n        0,\n        1,\n        0,\n        h[2],\n        h[5],\n        0,\n        1\n    ].map(num => round(num, 10)) as Matrix3d;\n};\n\nexport const matrixToTransform = (matrix: Matrix3d) =>\n    `matrix3d(${matrix.join(\", \")})`;\n\nexport const vectorToTransform = (vector: Vector) =>\n    `translate(${vector[0]}px, ${vector[1]}px)`;\n","import * as React from \"react\";\nimport { Anchor, Vector } from \"./layer\";\nimport { vectorToTransform } from \"./util\";\n\nconst anchorSize = 30;\nconst halfAnchor = anchorSize / 2;\n\nconst styles = {\n    container: {\n        width: anchorSize,\n        height: anchorSize,\n        borderRadius: \"50%\",\n        position: \"absolute\" as \"absolute\",\n        border: \"4px solid white\",\n        cursor: \"move\"\n    },\n    \"top-left\": {\n        left: -halfAnchor,\n        top: -halfAnchor\n    },\n    \"bottom-left\": {\n        left: -halfAnchor,\n        bottom: -halfAnchor\n    },\n    \"top-right\": {\n        top: -halfAnchor,\n        right: -halfAnchor\n    },\n    \"bottom-right\": {\n        bottom: -halfAnchor,\n        right: -halfAnchor\n    }\n};\n\nexport interface Props {\n    position: Anchor;\n    onMouseEnter?: (position: Anchor) => void;\n    // tslint:disable-next-line:no-any\n    onMouseDown: (evt: any, position: Anchor) => void;\n    onMouseUp: (position: Anchor) => void;\n    translation: Vector;\n    style?: React.CSSProperties;\n    className?: string;\n}\n\nexport const AnchorComponent: React.StatelessComponent<Props> = ({\n    position,\n    translation,\n    onMouseEnter,\n    onMouseDown,\n    onMouseUp,\n    className = \"\",\n    style = {}\n}) => (\n    <div\n        onMouseEnter={() => onMouseEnter && onMouseEnter(position)}\n        onMouseDown={evt => onMouseDown(evt, position)}\n        onMouseUp={() => onMouseUp(position)}\n        className={className}\n        style={{\n            ...styles.container,\n            ...styles[position],\n            ...style,\n            transform: vectorToTransform(translation)\n        }}\n    />\n);\n","import React from \"react\";\nimport Button from \"@material-ui/core/Button\";\nimport Grid from \"@material-ui/core/Grid\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport DeleteIcon from \"@material-ui/icons/Delete\";\n\nconst useStyles = makeStyles(theme => ({\n    button: {\n        margin: theme.spacing(1),\n        position: \"fixed\",\n        top: \"50vh\",\n        zIndex: 1000\n    }\n}));\n\nexport default function DeleteLocalStorage() {\n    const classes = useStyles();\n\n    return (\n        <Grid container alignItems=\"center\" justify=\"center\">\n            <Button\n                variant=\"contained\"\n                color=\"secondary\"\n                className={classes.button}\n                startIcon={<DeleteIcon />}\n            >\n                Reset Projection Mapping\n            </Button>\n        </Grid>\n    );\n}\n","import * as React from \"react\";\nimport { AnchorComponent } from \"./anchor\";\nimport {\n    matrixToTransform,\n    transformPointsToMatrix,\n    vectorToTransform\n} from \"./util\";\n\nimport DeleteLocalStorage from \"./deleteLocalStorage\";\n\n// Component interfaces\nexport interface Props {\n    style?: React.CSSProperties;\n    className?: string;\n    isEditMode?: boolean;\n    x?: number;\n    y?: number;\n    anchorStyle?: React.CSSProperties;\n    anchorClassName?: string;\n}\n\nexport interface Context {\n    isEditMode: boolean;\n}\n\nexport interface State {\n    matrix: Matrix3d;\n    translateDelta: { [key: string]: Vector };\n    sourcePoints?: RectPoints;\n    transformOrigin: Vector;\n    containerTranslate: Vector;\n}\n\nconst styles = {\n    container: {\n        position: \"relative\" as \"relative\"\n    }\n};\n\n// Sorted\nexport type Anchor = \"top-left\" | \"top-right\" | \"bottom-right\" | \"bottom-left\";\nconst anchors: Anchor[] = [\n    \"top-left\",\n    \"top-right\",\n    \"bottom-right\",\n    \"bottom-left\"\n];\n\n// 4x4 matrix\nexport type Matrix3d = [\n    number,\n    number,\n    number,\n    number,\n    number,\n    number,\n    number,\n    number,\n    number,\n    number,\n    number,\n    number,\n    number,\n    number,\n    number,\n    number\n];\n\n// top-left, top-right, bottom-right, bottom-left\nexport type RectPoints = [Vector, Vector, Vector, Vector];\n\nexport type Vector = [number, number]; // [x, y]\n\nconst defaultMatrix: Matrix3d = [\n    1,\n    0,\n    0,\n    0,\n    0,\n    1,\n    0,\n    0,\n    0,\n    0,\n    1,\n    0,\n    0,\n    0,\n    0,\n    1 // second and third for x and y position of element\n];\n\nconst _setDeltaVal = () => {\n    let deltaInitVals: any = {};\n    anchors.forEach(e => {\n        deltaInitVals[e] = [0, 0];\n    });\n    return deltaInitVals;\n};\n\nexport class Layer extends React.Component<Props, State> {\n    container: HTMLElement | null;\n    layerTranslateDelta: Vector | undefined;\n    anchorTranslateDelta: Vector | undefined;\n    isAnchorDragging = false;\n    targetPoints: RectPoints;\n    anchorMoving: Anchor | undefined;\n    state: State = {\n        matrix: defaultMatrix,\n        translateDelta: _setDeltaVal(),\n        sourcePoints: undefined,\n        transformOrigin: [0, 0],\n        containerTranslate: [this.props.x || 0, this.props.y || 0]\n    };\n\n    componentDidMount() {\n        console.log(\"starting projMap...\");\n        window.addEventListener(\"mousemove\", this.onAnchorMouseMove);\n        window.addEventListener(\"mousemove\", this.onMouseMove);\n        if (this.container) {\n            const { width, height } = this.container.getBoundingClientRect();\n            const sourcePoints = [\n                [0, 0],\n                [width, 0],\n                [width, height],\n                [0, height]\n            ] as RectPoints;\n\n            this.targetPoints = [...sourcePoints] as RectPoints;\n            this.setState({ sourcePoints });\n        }\n    }\n    componentDidUpdate(prevProps: any, prevState: State) {\n        // if entered keystone mode\n        if (!prevProps.isEditMode && this.props.isEditMode) {\n            // if found prev. keystone data\n            if (localStorage.getItem(\"projMap\")) {\n                console.log(\"loading prev. projMap...\");\n                let ls: any = localStorage.getItem(\"projMap\");\n                this.setState(JSON.parse(ls));\n            }\n            // if left keystone mode\n        } else if (prevProps.isEditMode && !this.props.isEditMode) {\n            console.log(\"saving edited projMap...\");\n            // save whatever keystone was in state\n            localStorage.setItem(\"projMap\", JSON.stringify(prevState));\n        }\n    }\n\n    componentWillUnmount() {\n        window.removeEventListener(\"mousemove\", this.onAnchorMouseMove);\n        window.removeEventListener(\"mousemove\", this.onMouseMove);\n    }\n\n    onAnchorMouseDown = (evt: any, position: any) => {\n        evt.stopPropagation();\n        this.anchorTranslateDelta = [\n            evt.pageX - this.state.translateDelta[position][0],\n            evt.pageY - this.state.translateDelta[position][1]\n        ];\n\n        this.anchorMoving = position;\n    };\n\n    onAnchorMouseMove = (evt: any) => {\n        if (\n            !this.anchorTranslateDelta ||\n            !this.state.sourcePoints ||\n            !this.anchorMoving\n        ) {\n            return;\n        }\n        evt.preventDefault();\n        evt.stopPropagation();\n        const vectorIndexToModify = anchors.indexOf(this.anchorMoving);\n\n        const deltaX = evt.pageX - this.anchorTranslateDelta[0];\n        const deltaY = evt.pageY - this.anchorTranslateDelta[1];\n\n        this.targetPoints[vectorIndexToModify] = [\n            this.state.sourcePoints[vectorIndexToModify][0] + deltaX,\n            this.state.sourcePoints[vectorIndexToModify][1] + deltaY\n        ];\n\n        this.setState({\n            matrix: transformPointsToMatrix(\n                this.state.sourcePoints,\n                this.targetPoints!\n            ),\n            translateDelta: {\n                ...this.state.translateDelta,\n                [this.anchorMoving]: [deltaX, deltaY]\n            }\n        });\n    };\n\n    onAnchorMouseUp = (position: any) => {\n        this.anchorTranslateDelta = undefined;\n        this.anchorMoving = undefined;\n    };\n\n    onMouseUp = () => {\n        this.layerTranslateDelta = undefined;\n    };\n\n    onMouseMove = (evt: any) => {\n        if (!this.layerTranslateDelta || !this.props.isEditMode) {\n            return;\n        }\n\n        const newVector: Vector = [\n            evt.pageX - this.layerTranslateDelta[0],\n            evt.pageY - this.layerTranslateDelta[1]\n        ];\n\n        this.setState({\n            containerTranslate: newVector\n        });\n    };\n\n    onMouseDown = (evt: any) => {\n        const { containerTranslate } = this.state;\n        this.layerTranslateDelta = [\n            evt.pageX - containerTranslate[0],\n            evt.pageY - containerTranslate[1]\n        ];\n    };\n\n    _clearLocalStraoge = () => {\n        if (localStorage.getItem(\"projMap\")) {\n            localStorage.removeItem(\"projMap\");\n        }\n        window.location.reload();\n    };\n\n    render() {\n        const {\n            style,\n            isEditMode,\n            className,\n            anchorStyle,\n            anchorClassName\n        } = this.props;\n        const {\n            translateDelta,\n            matrix,\n            containerTranslate,\n            transformOrigin\n        } = this.state;\n\n        return (\n            <React.Fragment>\n                {isEditMode && (\n                    <div onClick={() => this._clearLocalStraoge()}>\n                        <DeleteLocalStorage />\n                    </div>\n                )}\n\n                <div\n                    onMouseDown={this.onMouseDown}\n                    onMouseUp={this.onMouseUp}\n                    style={{\n                        cursor: isEditMode ? \"all-scroll\" : \"inherit\",\n                        position: \"relative\",\n                        display: \"inline-block\",\n                        transform: vectorToTransform(containerTranslate)\n                    }}\n                >\n                    <div\n                        ref={ref => {\n                            this.container = ref;\n                        }}\n                        style={{\n                            ...styles.container,\n                            ...style,\n                            pointerEvents: isEditMode ? \"none\" : \"all\",\n                            transform: matrixToTransform(matrix),\n                            transformOrigin: `${transformOrigin[0]}px ${transformOrigin[1]}px 0px`\n                        }}\n                        className={className}\n                    >\n                        {this.props.children}\n                    </div>\n                    {isEditMode && (\n                        <div>\n                            {anchors.map((anchor, index) => (\n                                <AnchorComponent\n                                    style={anchorStyle}\n                                    className={anchorClassName}\n                                    key={anchor}\n                                    translation={translateDelta[anchor]}\n                                    position={anchor}\n                                    onMouseDown={this.onAnchorMouseDown}\n                                    onMouseUp={this.onAnchorMouseUp}\n                                />\n                            ))}\n                        </div>\n                    )}\n                </div>\n            </React.Fragment>\n        );\n    }\n}\n","import React, { Component } from \"react\";\nimport MAP from \"./baseMap\";\nimport { connect } from \"react-redux\";\nimport { Layer } from \"../prjMap/layer\";\n\nclass MapContainer extends Component {\n    _checkKeystone = () => {\n        return this.props.menu.includes(\"KS\") ? true : false;\n    };\n\n    render() {\n        if (\n            this.props &&\n            this.props.cityioData &&\n            this.props.cityioData.header\n        ) {\n            return (\n                <Layer\n                    className=\"mapLayer\"\n                    style={{\n                        height: \"99.5vh\",\n                        width: \"100vw\"\n                    }}\n                    isEditMode={this._checkKeystone()}\n                >\n                    <MAP\n                        cityioData={this.props.cityioData}\n                        menu={this.props.menu}\n                    />\n                </Layer>\n            );\n        } else {\n            return null;\n        }\n    }\n}\n\nconst mapStateToProps = state => {\n    return {\n        cityioData: state.CITYIO,\n        menu: state.MENU\n    };\n};\n\nexport default connect(mapStateToProps, null)(MapContainer);\n","import React, { Component } from \"react\";\nimport { CircularGridLines, RadarChart } from \"react-vis\";\nimport settings from \"../../../settings/settings.json\";\nimport \"../../../../node_modules/react-vis/dist/style.css\";\nimport \"./Radar.css\";\n\nclass Radar extends Component {\n    constructor(props) {\n        super(props);\n        this.domain = settings.radar.domain;\n        this.colorRange = settings.radar.colorRange;\n        this.state = {\n            cityioData: {},\n            radarData: []\n        };\n\n        this.radarSize = 700;\n    }\n\n    generateData() {\n        let data = {};\n        let dataStatic = {};\n        for (let i in this.domain) {\n            // b/s data for now\n            data[this.domain[i].name] = this.props.cityioData.grid[i][0] / 10;\n            // compared with other b/s data\n            dataStatic[this.domain[i].name] = i / this.domain.length;\n        }\n        this.setState({ radarData: [data, dataStatic] });\n    }\n\n    componentDidMount() {\n        console.log(\">> init radar\");\n\n        this.generateData();\n    }\n\n    componentDidUpdate(prevProps, prevState) {\n        if (prevState.cityioData !== this.props.cityioData) {\n            this.setState({ cityioData: this.props.cityioData });\n            console.log(\"new radar data..\");\n            this.generateData();\n        }\n    }\n\n    render() {\n        return (\n            <RadarChart\n                className=\"Radar blur\"\n                animation\n                data={this.state.radarData}\n                domains={this.domain}\n                colorRange={this.colorRange}\n                style={{\n                    polygons: {\n                        fillOpacity: 0.2,\n                        strokeWidth: 2\n                    },\n                    axes: {\n                        text: {\n                            opacity: 0,\n                            fontWeight: 700,\n                            fill: \"white\"\n                        },\n                        strokeWidth: 0\n                    },\n                    labels: {\n                        textAnchor: \"middle\",\n                        fontSize: 12,\n                        fontWeight: \"600\",\n                        fill: \"white\"\n                    }\n                }}\n                margin={{\n                    left: this.radarSize / 6,\n                    top: this.radarSize / 6,\n                    bottom: this.radarSize / 6,\n                    right: this.radarSize / 6\n                }}\n                width={this.radarSize}\n                height={this.radarSize}\n            >\n                <CircularGridLines\n                    style={{\n                        fill: \"white\",\n                        fillOpacity: 0.1,\n                        backgroundColor: \"#fff\",\n                        opacity: 0.5,\n                        stroke: \"white\",\n                        width: 0.1\n                    }}\n                    tickValues={[...new Array(11)].map((v, i) => i / 10 - 1)}\n                />\n            </RadarChart>\n        );\n    }\n}\n\nexport default Radar;\n","import React, { Component } from \"react\";\nimport { connect } from \"react-redux\";\nimport Radar from \"./Radar/Radar\";\n\nclass VisContainer extends Component {\n    render() {\n        if (\n            this.props.menu &&\n            this.props.menu.includes(\"RADAR\") &&\n            this.props.cityioData &&\n            this.props.cityioData.grid\n        ) {\n            return <Radar cityioData={this.props.cityioData} />;\n        } else {\n            return null;\n        }\n    }\n}\n\nconst mapStateToProps = state => {\n    return {\n        cityioData: state.CITYIO,\n        menu: state.MENU\n    };\n};\n\nexport default connect(mapStateToProps, null)(VisContainer);\n","import { Provider } from \"react-redux\";\nimport \"./index.css\";\nimport configureStore from \"./redux/store\";\nimport CityIO from \"./services/cityIO/cityIO\";\nimport MenuContainer from \"./components/menu/menuContainer\";\nimport MapContainer from \"./components/baseMap/baseMapContainer\";\nimport VisContainer from \"./components/vis/visContainer\";\nimport React, { Component } from \"react\";\n\nconst store = configureStore();\n\nclass App extends Component {\n    render() {\n        return (\n            <Provider store={store}>\n                <MapContainer />\n                <CityIO />\n                <VisContainer />\n                <MenuContainer />\n            </Provider>\n        );\n    }\n}\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\n\nconst root = document.getElementById(\"root\");\nconst render = () => {\n    return ReactDOM.render(<App />, root);\n};\n\nrender(App);\n\nif (module.hot) {\n    module.hot.accept(\"./App\", () => {\n        const NextApp = require(\"./App\").default;\n        render(NextApp);\n    });\n}\n"],"sourceRoot":""}